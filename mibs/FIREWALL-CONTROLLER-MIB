FIREWALL-CONTROLLER-MIB DEFINITIONS ::= BEGIN

IMPORTS
    unix
        FROM SMUX-MIB
    MODULE-IDENTITY, OBJECT-TYPE, Unsigned32,
    INTEGER, OCTET STRING, OBJECT IDENTIFIER,
    IpAddress
        FROM SNMPv2-SMI
    DisplayString, RowStatus
        FROM SNMPv2-TC;

firewallController MODULE-IDENTITY
    LAST-UPDATED "202108300000Z"
    ORGANIZATION "AO Koncern Sozvezdie"
    CONTACT-INFO
            ""
    DESCRIPTION
            "The Firewall Controller MIB module."
    ::= { unix 199 }

firewallFilter OBJECT IDENTIFIER ::= { firewallController 1 }

firewallFilterForwardTable OBJECT-TYPE
    SYNTAX     SEQUENCE OF firewallFilterForwardEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            ""
    ::= { firewallFilter 1 }

firewallFilterForwardEntry OBJECT-TYPE
    SYNTAX     firewallFilterForwardEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            ""
    INDEX      { fcFFIndex }
    ::= { firewallFilterForwardTable 1 }

firewallFilterForwardEntry ::= SEQUENCE {
    fcFFIndex                               Unsigned32,
    fcFFSrcAddr                             IpAddress,
    fcFFDstAddr                             IpAddress
}

fcFFIndex OBJECT-TYPE
    SYNTAX     Unsigned32
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            "Entry index"
    ::= { firewallFilterForwardEntry 1 }

fcFFSrcAddr OBJECT-TYPE
    SYNTAX     IpAddress
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Source ip address"
    ::= { firewallFilterForwardEntry 2 }

fcFFSrcMask OBJECT-TYPE
    SYNTAX     IpAddress
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Source network mask"
    ::= { firewallFilterForwardEntry 3 }

fcFFDstAddr OBJECT-TYPE
    SYNTAX     IpAddress
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Destination ip address"
    ::= { firewallFilterForwardEntry 4 }

fcFFDstMask OBJECT-TYPE
    SYNTAX     IpAddress
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Destination network mask"
    ::= { firewallFilterForwardEntry 5 }

fcFFInIface OBJECT-TYPE
    SYNTAX     OCTET STRING
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Input interface"
    ::= { firewallFilterForwardEntry 6 }

fcFFOutIface OBJECT-TYPE
    SYNTAX     OCTET STRING
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Output interface"
    ::= { firewallFilterForwardEntry 7 }

fcFFProto OBJECT-TYPE
    SYNTAX     INTEGER
                       {
                        none(0),
                        icmp(1),
                        tcp(6),
                        udp(17)
                       }
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "OSI-4 protocol"
    ::= { firewallFilterForwardEntry 8 }

fcFFSrcPortMin OBJECT-TYPE
    SYNTAX     Unsigned32
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Source port range left-value"
    ::= { firewallFilterForwardEntry 9 }

fcFFSrcPortMax OBJECT-TYPE
    SYNTAX     Unsigned32
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Source port range right-value"
    ::= { firewallFilterForwardEntry 10 }

fcFFDstPortMin OBJECT-TYPE
    SYNTAX     Unsigned32
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Destination port range left-value"
    ::= { firewallFilterForwardEntry 11 }

fcFFDstPortMax OBJECT-TYPE
    SYNTAX     Unsigned32
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Destination port range right-value"
    ::= { firewallFilterForwardEntry 12 }

fcFFState OBJECT-TYPE
    SYNTAX     BIT STRING
                       {
                        none(0),
                        invalid(1),
                        established(2),
                        related(4),
                        new(8),
                       }
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Connection state"
    ::= { firewallFilterForwardEntry 13 }

fcFFAction OBJECT-TYPE
    SYNTAX     INTEGER
                       {
                        unknown(0),
                        accept(1),
                        drop(2),
                        reject(3),
                        snat(4),
                        dnat(5)
                       }
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Netfilter action"
    ::= { firewallFilterForwardEntry 14 }

fcFFActionParams OBJECT-TYPE
    SYNTAX     OCTET STRING
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Action parameters"
    ::= { firewallFilterForwardEntry 15 }

fcFFInverseFlags OBJECT-TYPE
    SYNTAX     BIT STRING
                        {
                         dport(0),
                         proto(1),
                         sport(2),
                         daddr(3),
                         saddr(4),
                         state(5),
                         outif(6),
                         inif(7)
                        }
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "Rule conditions inverse flags"
    ::= { firewallFilterForwardEntry 16 }


fcFFCommand OBJECT-TYPE
    SYNTAX     INTEGER
                       {
                        add(0),
                        delete(1)
                       }
    MAX-ACCESS read-write
    STATUS     current
    DESCRIPTION
            "Table entry commands"
    ::= { firewallFilterForwardEntry 17 }

fcFFPolicy OBJECT-TYPE
    SYNTAX     INTEGER
                       {
                        drop(0),
                        accept(1)
                       }
    MAX-ACCESS read-write
    STATUS     current
    DESCRIPTION
            "Default action"
    ::= { firewallFilter 2  }

END